<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Offerta Esclusiva - Consulenza con Thomas</title>

  <!-- Meta Pixel Code -->
  <script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '2180408928835338');
  fbq('track', 'PageView');
  fbq('track', 'Purchase', {
    value: 50.00,
    currency: 'EUR'
  });
  </script>
  <noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=2180408928835338&ev=PageView&noscript=1"/></noscript>
  <!-- End Meta Pixel Code -->

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --neon:#B8FC8D;
      --red:#FF3B3B;
      --gold1:#FFD700; 
      --gold2:#FFA500;
    }
    
    *{box-sizing:border-box;margin:0;padding:0}
    
    body{
      font-family:'Oswald',sans-serif;
      color:#fff;
      background:#000;
      overflow-x:hidden;
      min-height:100vh;
      position:relative;
    }

    /* Background con griglia e sfumature */
    .background{
      position:fixed;
      inset:0;
      z-index:0;
      background: 
        radial-gradient(circle at 50% 30%, rgba(184,252,141,.15) 0%, transparent 45%),
        radial-gradient(circle at 50% 70%, rgba(184,252,141,.1) 0%, transparent 50%),
        #000;
    }
    
    .grid{
      position:fixed;
      inset:0;
      z-index:1;
      opacity:.06;
      background-image:
        linear-gradient(rgba(184,252,141,1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(184,252,141,1) 1px, transparent 1px);
      background-size:50px 50px;
    }

    .container{
      max-width:900px;
      margin:0 auto;
      padding:0 20px;
      position:relative;
      z-index:2;
    }

    /* Top Banner */
    .top-banner{
      text-align:center;
      padding:25px 0 15px;
    }
    
    .live-pill{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:14px 35px;
      border-radius:999px;
      background:rgba(40,40,40,.9);
      backdrop-filter:blur(12px);
      font-size:16px;
      font-weight:600;
      letter-spacing:.2px;
    }
    
    .dot{
      width:10px;
      height:10px;
      border-radius:50%;
      background:var(--neon);
      box-shadow:0 0 15px rgba(184,252,141,.4);
      animation:pulse 2s infinite;
    }
    
    @keyframes pulse{
      50%{box-shadow:0 0 20px rgba(184,252,141,.5)}
    }

    /* Main Content */
    .main{
      text-align:center;
      padding:15px 0 40px;
    }

    .headline{
      font-size:46px;
      font-weight:700;
      color:var(--neon);
      text-transform:uppercase;
      margin-bottom:12px;
      text-shadow:0 0 20px rgba(184,252,141,.3);
      line-height:1;
    }

    .subheadline{
      font-size:24px;
      font-weight:400;
      margin-bottom:20px;
      line-height:1.25;
    }

    .warning{
      font-size:92px;
      font-weight:700;
      color:var(--red);
      text-transform:uppercase;
      margin:25px 0 15px;
      text-shadow:0 0 40px rgba(255,59,59,.6);
      animation:attention 2s ease-in-out infinite;
      letter-spacing:-1px;
    }

    @keyframes attention{
      0%, 100%{transform:scale(1)}
      50%{transform:scale(1.05)}
    }

    .bonus-text{
      font-size:22px;
      margin-bottom:25px;
      opacity:.95;
      line-height:1.3;
    }

    /* Video Container */
    .video-container{
      max-width:720px;
      margin:0 auto 30px;
      border-radius:20px;
      overflow:hidden;
      box-shadow:0 30px 80px rgba(0,0,0,.8);
    }

    .video-container img{
      width:100%;
      aspect-ratio:16/9;
      object-fit:cover;
      display:block;
    }

    /* Skip link sopra l'offerta */
    .skip-link{
      display:inline-block;
      margin:10px auto 25px;
      padding:8px 20px;
      color:rgba(255,255,255,.5);
      text-decoration:underline;
      font-size:14px;
      cursor:pointer;
      transition:all .3s;
      font-style:italic;
      opacity:.7;
    }

    .skip-link:hover{
      color:rgba(255,255,255,.7);
      opacity:.9;
    }

    /* Offer Box */
    .offer-box{
      background:linear-gradient(145deg,#1a1a1a,#0a0a0a);
      border:2px solid var(--neon);
      border-radius:25px;
      padding:40px;
      margin:30px auto;
      max-width:700px;
      box-shadow:
        0 30px 70px rgba(184,252,141,.2),
        inset 0 1px 0 rgba(255,255,255,.05);
    }

    .offer-title{
      font-size:42px;
      font-weight:700;
      color:var(--neon);
      text-transform:uppercase;
      margin-bottom:12px;
      text-shadow:0 0 25px rgba(184,252,141,.3);
    }

    .offer-subtitle{
      font-size:20px;
      margin-bottom:25px;
    }

    .offer-subtitle .red{
      color:var(--red);
      font-weight:600;
    }

    .offer-list{
      text-align:left;
      margin:25px 0;
      font-size:18px;
      line-height:1.7;
    }

    .offer-list li{
      margin:12px 0;
      padding-left:30px;
      position:relative;
      list-style:none;
    }

    .offer-list li:before{
      content:"✓";
      position:absolute;
      left:0;
      color:var(--neon);
      font-weight:bold;
      font-size:22px;
    }

    /* Price */
    .price-section{
      margin:30px 0;
      text-align:center;
    }

    .price{
      font-size:86px;
      font-weight:700;
      color:var(--neon);
      text-shadow:0 0 30px rgba(184,252,141,.4);
      line-height:1;
      margin:10px 0;
    }

    .price-compare{
      font-size:20px;
      color:var(--red);
      text-decoration:line-through;
      opacity:.8;
      margin-bottom:25px;
    }

    /* One Click Checkout Button */
    .cta-checkout{
      display:block;
      width:85%;
      max-width:450px;
      padding:26px 50px;
      margin:30px auto 10px;
      border-radius:999px;
      border:none;
      background:linear-gradient(135deg,#FFD700,#FF8C00);
      color:#000;
      font-family:'Oswald',sans-serif;
      font-size:22px;
      font-weight:900;
      text-transform:uppercase;
      cursor:pointer;
      box-shadow:
        0 25px 60px rgba(255,215,0,.6),
        0 10px 30px rgba(255,140,0,.4),
        inset 0 2px 0 rgba(255,255,255,.5),
        inset 0 -2px 0 rgba(0,0,0,.1);
      transition:all .3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position:relative;
      overflow:hidden;
      letter-spacing:.8px;
      transform:perspective(1px) translateZ(0);
    }

    .cta-checkout:hover{
      transform:translateY(-4px) scale(1.03);
      box-shadow:
        0 30px 70px rgba(255,215,0,.7),
        0 15px 40px rgba(255,140,0,.5),
        inset 0 2px 0 rgba(255,255,255,.6),
        inset 0 -2px 0 rgba(0,0,0,.15);
    }

    .cta-checkout:before{
      content:"";
      position:absolute;
      top:-50%;
      left:-50%;
      width:200%;
      height:200%;
      background:linear-gradient(
        45deg,
        transparent 30%,
        rgba(255,255,255,.5) 50%,
        transparent 70%
      );
      transform:rotate(45deg) translateX(-100%);
      transition:transform .6s;
    }

    .cta-checkout:hover:before{
      transform:rotate(45deg) translateX(100%);
    }

    .cta-checkout:active{
      transform:translateY(-2px) scale(1.01);
    }

    .cta-checkout:disabled{
      opacity:.5;
      cursor:not-allowed;
    }

    /* Loading state */
    .loading{
      display:none;
      text-align:center;
      color:var(--neon);
      margin:20px 0;
      font-size:18px;
      font-weight:600;
      animation:glow 1.5s infinite;
    }
    
    @keyframes glow{
      50%{text-shadow:0 0 25px rgba(184,252,141,.6)}
    }

    /* Footer */
    footer{
      margin-top:60px;
      padding-top:35px;
      border-top:1px solid rgba(184,252,141,.15);
      background:linear-gradient(180deg,transparent,rgba(0,0,0,1));
    }
    
    .footer-content{
      text-align:center;
      padding-bottom:10px;
    }

    /* Responsive */
    @media (max-width:768px){
      .headline{font-size:38px}
      .subheadline{font-size:20px}
      .warning{font-size:68px}
      .bonus-text{font-size:19px}
      .offer-box{padding:30px 25px}
      .offer-title{font-size:34px}
      .offer-list{font-size:16px}
      .price{font-size:68px}
      .cta-checkout{
        font-size:20px;
        padding:24px 40px;
        width:88%;
      }
    }
    
    @media (max-width:480px){
      .headline{
        font-size:30px;
        line-height:1.1;
        margin-bottom:10px;
      }
      .subheadline{
        font-size:18px;
        margin-bottom:15px;
      }
      .warning{
        font-size:52px;
        margin:20px 0 12px;
      }
      .bonus-text{
        font-size:16px;
        margin-bottom:20px;
      }
      .skip-link{
        font-size:12px;
        margin:8px auto 20px;
      }
      .offer-box{
        padding:25px 18px;
        margin:25px auto;
      }
      .offer-title{
        font-size:28px;
        margin-bottom:10px;
      }
      .offer-subtitle{font-size:16px}
      .offer-list{
        font-size:14px;
        margin:20px 0;
      }
      .offer-list li{
        padding-left:25px;
        margin:10px 0;
      }
      .price{font-size:54px}
      .price-compare{
        font-size:17px;
        margin-bottom:20px;
      }
      .cta-checkout{
        font-size:18px;
        padding:22px 35px;
        width:90%;
        margin:25px auto 8px;
      }
      .video-container{margin-bottom:20px}
      .live-pill{
        font-size:13px;
        padding:11px 22px;
      }
    }
  </style>
</head>
<body>
  <div class="background"></div>
  <div class="grid"></div>
  
  <div class="container">
    <div class="top-banner">
      <div class="live-pill">
        <span class="dot"></span>
        <strong>EVENTO ONLINE:</strong> Giovedì 9 ottobre ore 21:00
      </div>
    </div>

    <main class="main">
      <h1 class="headline">Offerta sbloccata con successo!</h1>
      <p class="subheadline">
        Riceverai a breve un'email con il link privato per<br>
        accedere ai contenuti
      </p>

      <h2 class="warning">RIMANI QUI!</h2>
      
      <p class="bonus-text">
        Perché hai modo di accedere ad un'offerta mai fatta prima...
      </p>

      <div class="video-container">
        <img src="1.png" alt="Video Offerta">
      </div>

      <!-- Skip link SOPRA l'offerta -->
      <a href="/thankyou2" class="skip-link" id="skipLink">
        No grazie, non mi interessa accedere all'offerta disponibile solo su questa<br>
        pagina e voglio solo confermare la mia iscrizione
      </a>

      <div class="offer-box">
        <h3 class="offer-title">CONSULENZA CON THOMAS</h3>
        <p class="offer-subtitle">
          30 minuti di chiamata privata<br>
          <span class="red">(DISPONIBILE SOLO SU QUESTA PAGINA)</span>
        </p>

        <ul class="offer-list">
          <li>Accedi a 30 minuti di video-consulenza privata direttamente con Thomas Macorig</li>
          <li>NB: Accedendo a questa offerta riceverai automaticamente a 200€ di sconto sul percorso che verrà lanciato il live il 9 ottobre alle 21:00</li>
        </ul>

        <div class="price-section">
          <div class="price">200€</div>
          <div class="price-compare">AL POSTO DI 500€</div>
        </div>

        <!-- One-click checkout button -->
        <button class="cta-checkout" id="oneClickBtn">
          → ACCEDI ORA ←
        </button>
      </div>

      <div class="loading">⏳ Elaborazione pagamento...</div>
    </main>

    <footer>
      <div class="footer-content">
        <img src="2.webp" alt="Logo" style="max-width:310px; width:100%; opacity:.85; margin-bottom:15px;">
        <p style="max-width:960px; margin:0 auto 15px; font-size:12px; line-height:1.8; color:rgba(255,255,255,.45); font-family:system-ui,sans-serif; padding:0 20px;">
          * I nostri risultati e quelli dei miei studenti non sono tipici. Acquistando o accedendo a Infobiz University potrai guadagnare di meno o di più rispetto ai risultati che vedi. Tutti i business comportano rischi e tempo per consolidarsi. Se stai cercando guadagni facili questo NON fa per te. Lasciando i tuoi dati accetti la Privacy Policy del sito. DYOR / NFA Copyright 2025 – TMC Holding LLC Tutti i diritti riservati.
        </p>
        <div style="display:flex; gap:28px; justify-content:center; padding-top:14px; border-top:1px solid rgba(255,255,255,.1);">
          <a href="https://learn.infobiz.com/privacy-policy-2/" target="_blank" style="color:rgba(255,255,255,.65); text-decoration:none; font-size:13px; font-family:system-ui,sans-serif; transition:.3s;">Privacy Policy</a>
          <a href="https://learn.infobiz.com/cookie-policy/" target="_blank" style="color:rgba(255,255,255,.65); text-decoration:none; font-size:13px; font-family:system-ui,sans-serif; transition:.3s;">Cookie Policy</a>
          <a href="https://learn.infobiz.com/terms-of-service/" target="_blank" style="color:rgba(255,255,255,.65); text-decoration:none; font-size:13px; font-family:system-ui,sans-serif; transition:.3s;">Terms of Service</a>
        </div>
      </div>
    </footer>
  </div>

  <script>
    // Recupera i dati salvati
    const userData = {
      name: sessionStorage.getItem('user_name') || '',
      email: sessionStorage.getItem('user_email') || '',
      phone: sessionStorage.getItem('user_phone') || '',
      paymentMethodId: sessionStorage.getItem('payment_method_id') || '' // Salvato dall'OTO1
    };

    console.log('Dati utente recuperati:', userData);

    // Gestione One-Click Checkout
    document.getElementById('oneClickBtn').addEventListener('click', async function() {
      const btn = this;
      const loading = document.querySelector('.loading');
      
      // Disabilita pulsante e mostra loading
      btn.disabled = true;
      btn.style.display = 'none';
      loading.style.display = 'block';
      
      try {
        
        // Invia richiesta one-click payment al backend
        const response = await fetch('/.netlify/functions/one-click-payment', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            paymentMethodId: userData.paymentMethodId,
            customerEmail: userData.email,
            amount: 20000, // 200€ in centesimi
            currency: 'eur',
            product: 'consulenza_thomas',
            description: 'Consulenza con Thomas - 30 minuti'
          })
        });

        const result = await response.json();
        
        if (result.success) {
          // Pagamento riuscito - vai a thankyou3
          window.location.href = '/thankyou3';
        } else if (result.requiresAction) {
          // Richiede autenticazione 3D Secure
          // In questo caso potresti dover gestire un modal Stripe
          alert('Il pagamento richiede una verifica aggiuntiva');
          window.location.href = '/thankyou2';
        } else {
          throw new Error(result.error || 'Pagamento non riuscito');
        }
        
      } catch (error) {
        console.error('Errore pagamento:', error);
        alert('Si è verificato un errore. Riprova più tardi.');
        // In caso di errore vai comunque a thankyou2
        window.location.href = '/thankyou2';
      }
    });

    // Skip link - rifiuta offerta
    document.getElementById('skipLink').addEventListener('click', function(e) {
      e.preventDefault();
      
      // Track rifiuto offerta
      if (typeof fbq !== 'undefined') {
        fbq('trackCustom', 'SkipOTO2');
      }
      
      window.location.href = '/thankyou2';
    });

    // Auto-scroll per mobile
    if (window.innerWidth < 768) {
      setTimeout(() => {
        window.scrollTo({
          top: document.querySelector('.headline').offsetTop - 20,
          behavior: 'smooth'
        });
      }, 500);
    }
  </script>
</body>
</html>